title: McAfee, ePO, Extra.DAT files, sniffing glue, and you
date: 2010/03/08 18:01:32 -0800
tags: [{"name":"ePO","id":5154636},{"name":"Extra.DAT","id":5154640},{"name":"McAfee","id":5154600}]
author: Professor Crabwise Stabbington
alias: /mcafee-epo-extradat-files-sniffing-glue-and-y

        <p>I haven&#8217;t found any reference to this fix when searching the Googles, so I&#8217;m dropping it out here. Comment if you find this useful.</p> <p></p> <p>While remediating the frequent updates to the <a href="http://vil.nai.com/vil/content/v_141235.htm">W32/Qakbot/Pinkslipbot</a> variants, I ran into an issue where the usual sandbagging-vendor response of &#8220;Oh, you don&#8217;t have all the latest patches? Call back when you do&#8221; was NOT going to cut it. </p> <p></p> <p>I&#8217;d been submitting the new variants to McAfee, like a good little soldier, and loading up the Extra.DAT files into our ePO server to make sure that they got pushed down to all of our workstation machines. Everything looked good, the Extra.DAT imported in okay, and tra-la, puppies and kittens for all, right? </p> <p></p> <p>Yeah, not so much. See here&#8217;s a thing with McAfee AntiVirus 8.7 (with all patches, from my research), and being managed by ePO. Let&#8217;s say you get an Extra.DAT file to handle the new variant of W32.Akbot, and you push it down to your clients. Hooray! Good jawrb! And lo, it came to pass, that production DAT files come out that handle detection and removal better than the off-the-cuff Extra.DAT file, so you pull the Extra.DAT out of production.</p> <p></p> <p>But let&#8217;s say that same virus makes its way back into your environment, but with a brand new update that is slipping by McAfee. So, once again, you submit it to McAfee, and they give you a brand spanking new Extra.DAT. Frickin&#8217; sweet, right? Yeah, not so much. Because while you load it into ePO fine, and manually installing it on a client seems to work, for some reason, none of your workstations will pick up this Extra.DAT. And this is why: </p> <p></p> <p><div class='p_embed p_image_embed'>
<a href="/media/getfile/files.posterous.com/sushispook/MXkrhHlPTpFtId3tVVffbjx1o83eEONw3PlIQjnv1GXyechBfZJFQx38dA3X/image001.png"><img alt="Image001" height="143" src="/media/getfile/files.posterous.com/sushispook/WaGZcJLckzvXEFjt7LdWtDzFEtHbp20M8F3YfXa5wnTkgJssZ7XDeiQFbeEQ/image001.png.scaled.500.jpg" width="500" /></a>
</div>
</p> <p></p> <p>Because it&#8217;s got the same detection name as a previous Extra.DAT. It doesn&#8217;t matter that it&#8217;s an entirely different DAT file, the odds are that your clients will keep rejecting this Extra.DAT because they&#8217;re convinced that they already got it, and it was superseded by production DAT files. So, whatchoo gonna do? Simple:</p> <p></p> <p><div class='p_embed p_image_embed'>
<a href="/media/getfile/files.posterous.com/sushispook/FbrRwPlmTuxlDGdsfhKJvgqgxPRIsMFxavtErA0wsKm4OGV4J8whVQzzcnd7/image002.png"><img alt="Image002" height="125" src="/media/getfile/files.posterous.com/sushispook/MkGzRpGD1CN6r8c7pTQshIKNRp1wd3A6tHMrmXTahpBY5QSkoPcdElkOzCBt/image002.png.scaled.500.jpg" width="500" /></a>
</div>
</p> <p></p> <p>Save it in notepad, and in ePO, check it into your Master Repository:</p> <p></p> <p><div class='p_embed p_image_embed'>
<img alt="Image003" height="168" src="/media/getfile/files.posterous.com/sushispook/pMc1dKlf27FAIaafEqdgmTn9z6aKXFDc8P6XjMW7U3w02eER2WO5jtM7wYEa/image003.png" width="431" />
</div>
</p> <p><i><span style="font-size: 9.0pt;">I&#8217;LL BET THIS VIRUS HAS A BIG PAYLOAD, AMIRITE GUYS? GUYS???</span></i></p> <p></p> <p>There you go. This is good to know if you&#8217;re dealing with repeated infections of a prolifically updated virus (a common occurrence for many malware packages now, as the malware writers have solid financial backing). In my experience, it will display, in the &#8220;About&#8221; page of your local McAfee Anti-Virus install, the actual name of the variant in the Extra.DAT field, and not your&#8230; ahem&#8230; special name. But name at your own risk, unless you really do want to explain the W32/DonkeypunchManagement virus to your boss. </p>  
